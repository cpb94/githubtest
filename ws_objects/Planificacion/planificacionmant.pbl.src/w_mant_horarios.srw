$PBExportHeader$w_mant_horarios.srw
forward
global type w_mant_horarios from w_int_con_empresa
end type
type cb_generar from commandbutton within w_mant_horarios
end type
type uo_calendario from u_em_campo_2 within w_mant_horarios
end type
type gb_6 from groupbox within w_mant_horarios
end type
type gb_5 from groupbox within w_mant_horarios
end type
type cb_6 from commandbutton within w_mant_horarios
end type
type r_4 from rectangle within w_mant_horarios
end type
type cb_borrar from commandbutton within w_mant_horarios
end type
type em_anyo from editmask within w_mant_horarios
end type
type st_1 from statictext within w_mant_horarios
end type
type st_8 from statictext within w_mant_horarios
end type
type lunes_hora_inicial from dropdownlistbox within w_mant_horarios
end type
type st_9 from statictext within w_mant_horarios
end type
type lunes_hora_final from dropdownlistbox within w_mant_horarios
end type
type st_2 from statictext within w_mant_horarios
end type
type st_3 from statictext within w_mant_horarios
end type
type martes_hora_inicial from dropdownlistbox within w_mant_horarios
end type
type st_4 from statictext within w_mant_horarios
end type
type martes_hora_final from dropdownlistbox within w_mant_horarios
end type
type st_5 from statictext within w_mant_horarios
end type
type st_6 from statictext within w_mant_horarios
end type
type miercoles_hora_inicial from dropdownlistbox within w_mant_horarios
end type
type st_7 from statictext within w_mant_horarios
end type
type miercoles_hora_final from dropdownlistbox within w_mant_horarios
end type
type st_10 from statictext within w_mant_horarios
end type
type st_11 from statictext within w_mant_horarios
end type
type jueves_hora_inicial from dropdownlistbox within w_mant_horarios
end type
type st_12 from statictext within w_mant_horarios
end type
type jueves_hora_final from dropdownlistbox within w_mant_horarios
end type
type st_13 from statictext within w_mant_horarios
end type
type st_14 from statictext within w_mant_horarios
end type
type viernes_hora_inicial from dropdownlistbox within w_mant_horarios
end type
type st_15 from statictext within w_mant_horarios
end type
type viernes_hora_final from dropdownlistbox within w_mant_horarios
end type
type st_16 from statictext within w_mant_horarios
end type
type st_17 from statictext within w_mant_horarios
end type
type sabado_hora_inicial from dropdownlistbox within w_mant_horarios
end type
type st_18 from statictext within w_mant_horarios
end type
type sabado_hora_final from dropdownlistbox within w_mant_horarios
end type
type st_19 from statictext within w_mant_horarios
end type
type st_20 from statictext within w_mant_horarios
end type
type domingo_hora_inicial from dropdownlistbox within w_mant_horarios
end type
type st_21 from statictext within w_mant_horarios
end type
type domingo_hora_final from dropdownlistbox within w_mant_horarios
end type
type st_22 from statictext within w_mant_horarios
end type
type st_23 from statictext within w_mant_horarios
end type
type st_24 from statictext within w_mant_horarios
end type
type st_25 from statictext within w_mant_horarios
end type
type st_26 from statictext within w_mant_horarios
end type
type st_27 from statictext within w_mant_horarios
end type
type st_28 from statictext within w_mant_horarios
end type
type lunes_fecha_inicio from datepicker within w_mant_horarios
end type
type st_29 from statictext within w_mant_horarios
end type
type st_30 from statictext within w_mant_horarios
end type
type st_31 from statictext within w_mant_horarios
end type
type st_32 from statictext within w_mant_horarios
end type
type st_33 from statictext within w_mant_horarios
end type
type st_34 from statictext within w_mant_horarios
end type
type st_35 from statictext within w_mant_horarios
end type
type martes_fecha_inicio from datepicker within w_mant_horarios
end type
type miercoles_fecha_inicio from datepicker within w_mant_horarios
end type
type jueves_fecha_inicio from datepicker within w_mant_horarios
end type
type viernes_fecha_inicio from datepicker within w_mant_horarios
end type
type sabado_fecha_inicio from datepicker within w_mant_horarios
end type
type domingo_fecha_inicio from datepicker within w_mant_horarios
end type
type lunes_fecha_fin from datepicker within w_mant_horarios
end type
type martes_fecha_fin from datepicker within w_mant_horarios
end type
type miercoles_fecha_fin from datepicker within w_mant_horarios
end type
type jueves_fecha_fin from datepicker within w_mant_horarios
end type
type viernes_fecha_fin from datepicker within w_mant_horarios
end type
type sabado_fecha_fin from datepicker within w_mant_horarios
end type
type domingo_fecha_fin from datepicker within w_mant_horarios
end type
type p_1 from picture within w_mant_horarios
end type
type p_2 from picture within w_mant_horarios
end type
type p_3 from picture within w_mant_horarios
end type
type p_4 from picture within w_mant_horarios
end type
type p_5 from picture within w_mant_horarios
end type
type p_6 from picture within w_mant_horarios
end type
type p_7 from picture within w_mant_horarios
end type
type todos_calendarios from checkbox within w_mant_horarios
end type
type r_1 from rectangle within w_mant_horarios
end type
end forward

global type w_mant_horarios from w_int_con_empresa
integer x = 471
integer y = 4
integer width = 4101
integer height = 1776
cb_generar cb_generar
uo_calendario uo_calendario
gb_6 gb_6
gb_5 gb_5
cb_6 cb_6
r_4 r_4
cb_borrar cb_borrar
em_anyo em_anyo
st_1 st_1
st_8 st_8
lunes_hora_inicial lunes_hora_inicial
st_9 st_9
lunes_hora_final lunes_hora_final
st_2 st_2
st_3 st_3
martes_hora_inicial martes_hora_inicial
st_4 st_4
martes_hora_final martes_hora_final
st_5 st_5
st_6 st_6
miercoles_hora_inicial miercoles_hora_inicial
st_7 st_7
miercoles_hora_final miercoles_hora_final
st_10 st_10
st_11 st_11
jueves_hora_inicial jueves_hora_inicial
st_12 st_12
jueves_hora_final jueves_hora_final
st_13 st_13
st_14 st_14
viernes_hora_inicial viernes_hora_inicial
st_15 st_15
viernes_hora_final viernes_hora_final
st_16 st_16
st_17 st_17
sabado_hora_inicial sabado_hora_inicial
st_18 st_18
sabado_hora_final sabado_hora_final
st_19 st_19
st_20 st_20
domingo_hora_inicial domingo_hora_inicial
st_21 st_21
domingo_hora_final domingo_hora_final
st_22 st_22
st_23 st_23
st_24 st_24
st_25 st_25
st_26 st_26
st_27 st_27
st_28 st_28
lunes_fecha_inicio lunes_fecha_inicio
st_29 st_29
st_30 st_30
st_31 st_31
st_32 st_32
st_33 st_33
st_34 st_34
st_35 st_35
martes_fecha_inicio martes_fecha_inicio
miercoles_fecha_inicio miercoles_fecha_inicio
jueves_fecha_inicio jueves_fecha_inicio
viernes_fecha_inicio viernes_fecha_inicio
sabado_fecha_inicio sabado_fecha_inicio
domingo_fecha_inicio domingo_fecha_inicio
lunes_fecha_fin lunes_fecha_fin
martes_fecha_fin martes_fecha_fin
miercoles_fecha_fin miercoles_fecha_fin
jueves_fecha_fin jueves_fecha_fin
viernes_fecha_fin viernes_fecha_fin
sabado_fecha_fin sabado_fecha_fin
domingo_fecha_fin domingo_fecha_fin
p_1 p_1
p_2 p_2
p_3 p_3
p_4 p_4
p_5 p_5
p_6 p_6
p_7 p_7
todos_calendarios todos_calendarios
r_1 r_1
end type
global w_mant_horarios w_mant_horarios

forward prototypes
public subroutine f_actualizar_dia (string fecha_inicio, string fecha_fin, string hora_inicio, string hora_fin, string calendario, string anyo, string dia_semana)
end prototypes

public subroutine f_actualizar_dia (string fecha_inicio, string fecha_fin, string hora_inicio, string hora_fin, string calendario, string anyo, string dia_semana);date inicio
date fin
integer registros
boolean fallo

fallo = false

inicio = date(fecha_inicio)

fin = date(fecha_fin)

if inicio > fin then
	
	messagebox("Error", "La fecha de inicio tiene que ser menor o igual a la fecha fin")

else
	
	if calendario = '' then
		
		messagebox("Error", "No has seleccionado calendario")
		
		else
			
			select COUNT (*)
			into :registros
			from horarios 
			where calendario = :calendario
			and anyo = :anyo;
			
			if registros > 0 then
				
				if hora_inicio = 'Inactivo' or hora_fin = 'Inactivo' then
					
					if todos_calendarios.checked = true then
					
						update horarios
						
						set activa = 'N'
						
						where DATENAME(weekday,fecha) = :dia_semana
									
						and anyo = :anyo
						
						and convert (date, fecha) >= :inicio
						
						and convert(date, fecha) <= :fin
						
						USING SQLCA;
						
						if SQLCA.SQLCode <> 0 then
							
								fallo = true
			
						end if
						
					else
						
						update horarios
						
						set activa = 'N'
						
						where DATENAME(weekday,fecha) = :dia_semana
						
						and calendario = :calendario
						
						and anyo = :anyo
						
						and convert (date, fecha) >= :inicio
						
						and convert(date, fecha) <= :fin
						
						USING SQLCA;
						
						if SQLCA.SQLCode <> 0 then
							
								fallo = true
			
						end if
						
					end if
					
				else
					
					if todos_calendarios.checked = true then
			
						update horarios 
						
						set activa = 'S'
									
						where DATENAME(weekday,fecha) = :dia_semana
						
						and hora >= :hora_inicio and hora <= :hora_fin
						
					
						and anyo = : anyo
						
						and convert (date, fecha) >= : inicio
						
						and convert (date, fecha) <= : fin
						
						USING SQLCA;
						
						if SQLCA.SQLCode <> 0 then
									
									fallo = true
						end if
					
					else
						
						update horarios 
						
						set activa = 'S'
									
						where DATENAME(weekday,fecha) = :dia_semana
						
						and hora >= :hora_inicio and hora <= :hora_fin
						
						and calendario = :calendario
						
						and anyo = : anyo
						
						and convert (date, fecha) >= : inicio
						
						and convert (date, fecha) <= : fin
						
						USING SQLCA;
						
						if SQLCA.SQLCode <> 0 then
									
									fallo = true
						end if
					
				end if					
					
		end if
				
				if fallo = true then
					
					rollback;
					messagebox ("Error","No se pudo actualizar el calendario")
				else
					commit;
					messagebox ("Aviso","El calendario se ha actualizado con éxito")
					
				end if
					
			else
				
				messagebox("Error","No existe el calendario")
			
			end if
	end if
end if



end subroutine

on w_mant_horarios.create
int iCurrent
call super::create
this.cb_generar=create cb_generar
this.uo_calendario=create uo_calendario
this.gb_6=create gb_6
this.gb_5=create gb_5
this.cb_6=create cb_6
this.r_4=create r_4
this.cb_borrar=create cb_borrar
this.em_anyo=create em_anyo
this.st_1=create st_1
this.st_8=create st_8
this.lunes_hora_inicial=create lunes_hora_inicial
this.st_9=create st_9
this.lunes_hora_final=create lunes_hora_final
this.st_2=create st_2
this.st_3=create st_3
this.martes_hora_inicial=create martes_hora_inicial
this.st_4=create st_4
this.martes_hora_final=create martes_hora_final
this.st_5=create st_5
this.st_6=create st_6
this.miercoles_hora_inicial=create miercoles_hora_inicial
this.st_7=create st_7
this.miercoles_hora_final=create miercoles_hora_final
this.st_10=create st_10
this.st_11=create st_11
this.jueves_hora_inicial=create jueves_hora_inicial
this.st_12=create st_12
this.jueves_hora_final=create jueves_hora_final
this.st_13=create st_13
this.st_14=create st_14
this.viernes_hora_inicial=create viernes_hora_inicial
this.st_15=create st_15
this.viernes_hora_final=create viernes_hora_final
this.st_16=create st_16
this.st_17=create st_17
this.sabado_hora_inicial=create sabado_hora_inicial
this.st_18=create st_18
this.sabado_hora_final=create sabado_hora_final
this.st_19=create st_19
this.st_20=create st_20
this.domingo_hora_inicial=create domingo_hora_inicial
this.st_21=create st_21
this.domingo_hora_final=create domingo_hora_final
this.st_22=create st_22
this.st_23=create st_23
this.st_24=create st_24
this.st_25=create st_25
this.st_26=create st_26
this.st_27=create st_27
this.st_28=create st_28
this.lunes_fecha_inicio=create lunes_fecha_inicio
this.st_29=create st_29
this.st_30=create st_30
this.st_31=create st_31
this.st_32=create st_32
this.st_33=create st_33
this.st_34=create st_34
this.st_35=create st_35
this.martes_fecha_inicio=create martes_fecha_inicio
this.miercoles_fecha_inicio=create miercoles_fecha_inicio
this.jueves_fecha_inicio=create jueves_fecha_inicio
this.viernes_fecha_inicio=create viernes_fecha_inicio
this.sabado_fecha_inicio=create sabado_fecha_inicio
this.domingo_fecha_inicio=create domingo_fecha_inicio
this.lunes_fecha_fin=create lunes_fecha_fin
this.martes_fecha_fin=create martes_fecha_fin
this.miercoles_fecha_fin=create miercoles_fecha_fin
this.jueves_fecha_fin=create jueves_fecha_fin
this.viernes_fecha_fin=create viernes_fecha_fin
this.sabado_fecha_fin=create sabado_fecha_fin
this.domingo_fecha_fin=create domingo_fecha_fin
this.p_1=create p_1
this.p_2=create p_2
this.p_3=create p_3
this.p_4=create p_4
this.p_5=create p_5
this.p_6=create p_6
this.p_7=create p_7
this.todos_calendarios=create todos_calendarios
this.r_1=create r_1
iCurrent=UpperBound(this.Control)
this.Control[iCurrent+1]=this.cb_generar
this.Control[iCurrent+2]=this.uo_calendario
this.Control[iCurrent+3]=this.gb_6
this.Control[iCurrent+4]=this.gb_5
this.Control[iCurrent+5]=this.cb_6
this.Control[iCurrent+6]=this.r_4
this.Control[iCurrent+7]=this.cb_borrar
this.Control[iCurrent+8]=this.em_anyo
this.Control[iCurrent+9]=this.st_1
this.Control[iCurrent+10]=this.st_8
this.Control[iCurrent+11]=this.lunes_hora_inicial
this.Control[iCurrent+12]=this.st_9
this.Control[iCurrent+13]=this.lunes_hora_final
this.Control[iCurrent+14]=this.st_2
this.Control[iCurrent+15]=this.st_3
this.Control[iCurrent+16]=this.martes_hora_inicial
this.Control[iCurrent+17]=this.st_4
this.Control[iCurrent+18]=this.martes_hora_final
this.Control[iCurrent+19]=this.st_5
this.Control[iCurrent+20]=this.st_6
this.Control[iCurrent+21]=this.miercoles_hora_inicial
this.Control[iCurrent+22]=this.st_7
this.Control[iCurrent+23]=this.miercoles_hora_final
this.Control[iCurrent+24]=this.st_10
this.Control[iCurrent+25]=this.st_11
this.Control[iCurrent+26]=this.jueves_hora_inicial
this.Control[iCurrent+27]=this.st_12
this.Control[iCurrent+28]=this.jueves_hora_final
this.Control[iCurrent+29]=this.st_13
this.Control[iCurrent+30]=this.st_14
this.Control[iCurrent+31]=this.viernes_hora_inicial
this.Control[iCurrent+32]=this.st_15
this.Control[iCurrent+33]=this.viernes_hora_final
this.Control[iCurrent+34]=this.st_16
this.Control[iCurrent+35]=this.st_17
this.Control[iCurrent+36]=this.sabado_hora_inicial
this.Control[iCurrent+37]=this.st_18
this.Control[iCurrent+38]=this.sabado_hora_final
this.Control[iCurrent+39]=this.st_19
this.Control[iCurrent+40]=this.st_20
this.Control[iCurrent+41]=this.domingo_hora_inicial
this.Control[iCurrent+42]=this.st_21
this.Control[iCurrent+43]=this.domingo_hora_final
this.Control[iCurrent+44]=this.st_22
this.Control[iCurrent+45]=this.st_23
this.Control[iCurrent+46]=this.st_24
this.Control[iCurrent+47]=this.st_25
this.Control[iCurrent+48]=this.st_26
this.Control[iCurrent+49]=this.st_27
this.Control[iCurrent+50]=this.st_28
this.Control[iCurrent+51]=this.lunes_fecha_inicio
this.Control[iCurrent+52]=this.st_29
this.Control[iCurrent+53]=this.st_30
this.Control[iCurrent+54]=this.st_31
this.Control[iCurrent+55]=this.st_32
this.Control[iCurrent+56]=this.st_33
this.Control[iCurrent+57]=this.st_34
this.Control[iCurrent+58]=this.st_35
this.Control[iCurrent+59]=this.martes_fecha_inicio
this.Control[iCurrent+60]=this.miercoles_fecha_inicio
this.Control[iCurrent+61]=this.jueves_fecha_inicio
this.Control[iCurrent+62]=this.viernes_fecha_inicio
this.Control[iCurrent+63]=this.sabado_fecha_inicio
this.Control[iCurrent+64]=this.domingo_fecha_inicio
this.Control[iCurrent+65]=this.lunes_fecha_fin
this.Control[iCurrent+66]=this.martes_fecha_fin
this.Control[iCurrent+67]=this.miercoles_fecha_fin
this.Control[iCurrent+68]=this.jueves_fecha_fin
this.Control[iCurrent+69]=this.viernes_fecha_fin
this.Control[iCurrent+70]=this.sabado_fecha_fin
this.Control[iCurrent+71]=this.domingo_fecha_fin
this.Control[iCurrent+72]=this.p_1
this.Control[iCurrent+73]=this.p_2
this.Control[iCurrent+74]=this.p_3
this.Control[iCurrent+75]=this.p_4
this.Control[iCurrent+76]=this.p_5
this.Control[iCurrent+77]=this.p_6
this.Control[iCurrent+78]=this.p_7
this.Control[iCurrent+79]=this.todos_calendarios
this.Control[iCurrent+80]=this.r_1
end on

on w_mant_horarios.destroy
call super::destroy
if IsValid(MenuID) then destroy(MenuID)
destroy(this.cb_generar)
destroy(this.uo_calendario)
destroy(this.gb_6)
destroy(this.gb_5)
destroy(this.cb_6)
destroy(this.r_4)
destroy(this.cb_borrar)
destroy(this.em_anyo)
destroy(this.st_1)
destroy(this.st_8)
destroy(this.lunes_hora_inicial)
destroy(this.st_9)
destroy(this.lunes_hora_final)
destroy(this.st_2)
destroy(this.st_3)
destroy(this.martes_hora_inicial)
destroy(this.st_4)
destroy(this.martes_hora_final)
destroy(this.st_5)
destroy(this.st_6)
destroy(this.miercoles_hora_inicial)
destroy(this.st_7)
destroy(this.miercoles_hora_final)
destroy(this.st_10)
destroy(this.st_11)
destroy(this.jueves_hora_inicial)
destroy(this.st_12)
destroy(this.jueves_hora_final)
destroy(this.st_13)
destroy(this.st_14)
destroy(this.viernes_hora_inicial)
destroy(this.st_15)
destroy(this.viernes_hora_final)
destroy(this.st_16)
destroy(this.st_17)
destroy(this.sabado_hora_inicial)
destroy(this.st_18)
destroy(this.sabado_hora_final)
destroy(this.st_19)
destroy(this.st_20)
destroy(this.domingo_hora_inicial)
destroy(this.st_21)
destroy(this.domingo_hora_final)
destroy(this.st_22)
destroy(this.st_23)
destroy(this.st_24)
destroy(this.st_25)
destroy(this.st_26)
destroy(this.st_27)
destroy(this.st_28)
destroy(this.lunes_fecha_inicio)
destroy(this.st_29)
destroy(this.st_30)
destroy(this.st_31)
destroy(this.st_32)
destroy(this.st_33)
destroy(this.st_34)
destroy(this.st_35)
destroy(this.martes_fecha_inicio)
destroy(this.miercoles_fecha_inicio)
destroy(this.jueves_fecha_inicio)
destroy(this.viernes_fecha_inicio)
destroy(this.sabado_fecha_inicio)
destroy(this.domingo_fecha_inicio)
destroy(this.lunes_fecha_fin)
destroy(this.martes_fecha_fin)
destroy(this.miercoles_fecha_fin)
destroy(this.jueves_fecha_fin)
destroy(this.viernes_fecha_fin)
destroy(this.sabado_fecha_fin)
destroy(this.domingo_fecha_fin)
destroy(this.p_1)
destroy(this.p_2)
destroy(this.p_3)
destroy(this.p_4)
destroy(this.p_5)
destroy(this.p_6)
destroy(this.p_7)
destroy(this.todos_calendarios)
destroy(this.r_1)
end on

event open;call super::open;integer permiso

permiso = f_permiso_usuario(this.classname(), nombre_usuario)
choose case  permiso
	case 1
		cb_borrar.visible = false
		cb_generar.visible = false
end choose

//dw_1.SetTransObject (SQLCA)


em_anyo.text = String(Year(Today()))


lunes_hora_inicial.selectitem(25) //POR DEFECTO, INACTIVO
lunes_hora_final.selectitem(25)

martes_hora_inicial.selectitem(25)
martes_hora_final.selectitem(25)

miercoles_hora_inicial.selectitem(25)
miercoles_hora_final.selectitem(25)

jueves_hora_inicial.selectitem(25)
jueves_hora_final.selectitem(25)

viernes_hora_inicial.selectitem(25)
viernes_hora_final.selectitem(25)

sabado_hora_inicial.selectitem(25)
sabado_hora_final.selectitem(25)

domingo_hora_inicial.selectitem(25)
domingo_hora_final.selectitem(25)
end event

event activate;call super::activate;w_mant_meses = ventanas_activas[id_ventana_activa].ventana
end event

type ole_cont_pro from w_int_con_empresa`ole_cont_pro within w_mant_horarios
integer x = 439
integer y = 1464
integer height = 60
integer taborder = 170
end type

type sle_opcion_orden from w_int_con_empresa`sle_opcion_orden within w_mant_horarios
end type

type st_empresa from w_int_con_empresa`st_empresa within w_mant_horarios
integer x = 27
integer y = 16
integer width = 3963
integer height = 92
integer textsize = -12
end type

type cb_generar from commandbutton within w_mant_horarios
integer x = 2139
integer y = 164
integer width = 389
integer height = 140
boolean bringtotop = true
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Generar"
end type

event clicked;datetime fecha_actual, fecha_cal, fecha_inicial
integer v_anyo, v_mes, v_dia, mes, i, hora, hora_inicial, hora_final
string v_calendario, dia_nombre
decimal v_horas
boolean fallo = false
integer registros

boolean error_horas = false
boolean continuar = true


//PROGRAMA


fecha_Actual = datetime(date('01/01/'+em_anyo.text))

fecha_inicial = fecha_Actual

i = 0

select COUNT (*)
into :registros
from horarios 
where calendario = :uo_calendario.em_codigo.text
and anyo = :em_anyo.text;


if registros > 0 then
	continuar = false
	messagebox("Aviso", "Ya existe un calendario para ese año, debe borrarlo antes de generar.", Exclamation!) 
end if

if continuar = true then

		select top 1 calendario
		into :v_calendario
		from horarios
		where anyo = :em_anyo.text;
		
		if isnull(v_calendario) then
			v_calendario = ''
		end if
		
		if  v_calendario <> '' then
//		if  1= 2  then
			
			insert into horarios (empresa,fecha,calendario,anyo,mes,dia,hora,activa)
			
			select empresa, fecha, :uo_calendario.em_codigo.text, :em_anyo.text, mes, dia, hora,
					
						CASE
								WHEN DATENAME(weekday,fecha) = 'Lunes'
								
								then 
									CASE	
										WHEN :lunes_hora_inicial.text = 'Inactivo' or :lunes_hora_final.text = 'Inactivo'
											then 'N'
											
										WHEN hora >= :lunes_hora_inicial.text and hora <= :lunes_hora_final.text
											then 'S'
											ELSE 'N'
									END
									
								WHEN DATENAME(weekday,fecha) = 'Martes'
								
								then 
									CASE
										WHEN :martes_hora_inicial.text = 'Inactivo' or :martes_hora_final.text = 'Inactivo'
											then 'N'
										WHEN hora >= :martes_hora_inicial.text and hora <= :martes_hora_final.text 
											then 'S'
											ELSE 'N'
									END
									
								WHEN DATENAME(weekday,fecha) = 'Miércoles'
								
								then 
									CASE
										WHEN :miercoles_hora_inicial.text = 'Inactivo' or :miercoles_hora_final.text = 'Inactivo'
											then 'N'
										WHEN hora >= :miercoles_hora_inicial.text and hora <= :miercoles_hora_final.text 
											then 'S'
											ELSE 'N'
									END
									
								WHEN DATENAME(weekday,fecha) = 'Jueves'
								
								then 
									CASE
										WHEN :jueves_hora_inicial.text = 'Inactivo' or :jueves_hora_final.text = 'Inactivo'
											then 'N'
										WHEN hora >= :jueves_hora_inicial.text and hora <= :jueves_hora_final.text 
											then 'S'
											ELSE 'N'
									END
									
								WHEN DATENAME(weekday,fecha) = 'Viernes'
								
								then 
									CASE	
										WHEN :viernes_hora_inicial.text = 'Inactivo' or :viernes_hora_final.text = 'Inactivo'
											then 'N'
										WHEN hora >= :viernes_hora_inicial.text and hora <= :viernes_hora_final.text
											then 'S'
											ELSE 'N'
									END
									
								WHEN DATENAME(weekday,fecha) = 'Sábado'
								
								then 
									CASE
										WHEN :sabado_hora_inicial.text = 'Inactivo' or :sabado_hora_final.text = 'Inactivo'
											then 'N'
										WHEN hora >= :sabado_hora_inicial.text and hora <= :sabado_hora_final.text 
											then 'S'
											ELSE 'N'
									END
									
								WHEN DATENAME(weekday,fecha) = 'Domingo'
								
								then 
									CASE
										WHEN :domingo_hora_inicial.text = 'Inactivo' or :domingo_hora_final.text = 'Inactivo'
											then 'N'
										WHEN hora >= :domingo_hora_inicial.text and hora <= :domingo_hora_final.text 
											then 'S'
											ELSE 'N'
									END
						END
						
				from horarios
				
				where anyo = :em_anyo.text
				
				and calendario = :v_calendario;
			
				if SQLCA.SQLCode <> 0 then
					rollback;
					messagebox ("Error","No se pudo generar el calendario")
				else
					commit;
					messagebox ("Aviso","El calendario se ha generado con éxito")
				end if
				
	else
			DO WHILE  fecha_actual <> datetime(date('01/01/'+string(integer(em_anyo.text)+1)))
				i = i+1
				
				v_anyo = integer(em_anyo.text)
				v_mes = month(date(fecha_actual))
				v_dia = day(date(fecha_actual))
				v_calendario = uo_calendario.em_codigo.text
			
				for hora = 0 to 23
					
					fecha_cal = datetime( date(fecha_actual), time(string(hora)))
					
					insert into horarios (empresa,fecha,calendario,anyo,mes,dia,hora,activa)
					
					values (:codigo_empresa, :fecha_cal,:v_calendario,:v_anyo,:v_mes,:v_dia,:hora,
					
						CASE
								WHEN DATENAME(weekday,:fecha_actual) = 'Lunes'
								
								then 
									CASE	
										WHEN :lunes_hora_inicial.text = 'Inactivo' or :lunes_hora_final.text = 'Inactivo'
											then 'N'
											
										WHEN :hora >= :lunes_hora_inicial.text and :hora <= :lunes_hora_final.text
											then 'S'
											ELSE 'N'
									END
									
								WHEN DATENAME(weekday,:fecha_actual) = 'Martes'
								
								then 
									CASE
										WHEN :martes_hora_inicial.text = 'Inactivo' or :martes_hora_final.text = 'Inactivo'
											then 'N'
										WHEN :hora >= :martes_hora_inicial.text and :hora <= :martes_hora_final.text 
											then 'S'
											ELSE 'N'
									END
									
								WHEN DATENAME(weekday,:fecha_actual) = 'Miércoles'
								
								then 
									CASE
										WHEN :miercoles_hora_inicial.text = 'Inactivo' or :miercoles_hora_final.text = 'Inactivo'
											then 'N'
										WHEN :hora >= :miercoles_hora_inicial.text and :hora <= :miercoles_hora_final.text 
											then 'S'
											ELSE 'N'
									END
									
								WHEN DATENAME(weekday,:fecha_actual) = 'Jueves'
								
								then 
									CASE
										WHEN :jueves_hora_inicial.text = 'Inactivo' or :jueves_hora_final.text = 'Inactivo'
											then 'N'
										WHEN :hora >= :jueves_hora_inicial.text and :hora <= :jueves_hora_final.text 
											then 'S'
											ELSE 'N'
									END
									
								WHEN DATENAME(weekday,:fecha_actual) = 'Viernes'
								
								then 
									CASE	
										WHEN :viernes_hora_inicial.text = 'Inactivo' or :viernes_hora_final.text = 'Inactivo'
											then 'N'
										WHEN :hora >= :viernes_hora_inicial.text and :hora <= :viernes_hora_final.text
											then 'S'
											ELSE 'N'
									END
									
								WHEN DATENAME(weekday,:fecha_actual) = 'Sábado'
								
								then 
									CASE
										WHEN :sabado_hora_inicial.text = 'Inactivo' or :sabado_hora_final.text = 'Inactivo'
											then 'N'
										WHEN :hora >= :sabado_hora_inicial.text and :hora <= :sabado_hora_final.text 
											then 'S'
											ELSE 'N'
									END
									
								WHEN DATENAME(weekday,:fecha_actual) = 'Domingo'
								
								then 
									CASE
										WHEN :domingo_hora_inicial.text = 'Inactivo' or :domingo_hora_final.text = 'Inactivo'
											then 'N'
										WHEN :hora >= :domingo_hora_inicial.text and :hora <= :domingo_hora_final.text 
											then 'S'
											ELSE 'N'
									END
			
						END
					
					);
					
				
							
				next
				
				if SQLCA.SQLCode <> 0 then
					fallo = true
				end if
				
				fecha_actual = datetime(RelativeDate (date(fecha_actual), 1 ))	
			
				f_mensaje_proceso ("Generando Calendario", i, daysafter(date(fecha_inicial),date('01/01/'+string(integer(em_anyo.text)+1))))
			LOOP
			
			if fallo then
				rollback;
				messagebox ("Error","No se pudo generar el calendario")
			else
				commit;
				messagebox ("Aviso","El calendario se ha generado con éxito")
			end if

	end if
end if
end event

type uo_calendario from u_em_campo_2 within w_mant_horarios
event destroy ( )
integer x = 338
integer y = 220
integer width = 1381
integer height = 68
integer taborder = 10
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
end type

on uo_calendario.destroy
call u_em_campo_2::destroy
end on

event getfocus;call super::getfocus;valor_empresa = false
ue_titulo     = "Ayuda seleccion de Calendarios"
ue_datawindow = "dw_ayuda_calendarios"
ue_filtro     = ""

end event

event modificado;call super::modificado;string des_calendario
integer mes

select descripcion
into :des_calendario
from prodcalendarios
where codigo = :uo_calendario.em_codigo.text;

uo_calendario.em_campo.text = des_calendario
IF Trim(uo_calendario.em_campo.text)="" THEN 
 IF Trim(uo_calendario.em_codigo.text)<>"" Then uo_calendario.em_campo.SetFocus()
 uo_calendario.em_campo.text=""
 uo_calendario.em_codigo.text=""
END IF

end event

type gb_6 from groupbox within w_mant_horarios
integer x = 1755
integer y = 164
integer width = 370
integer height = 140
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 67108864
string text = "Año"
end type

type gb_5 from groupbox within w_mant_horarios
integer x = 315
integer y = 164
integer width = 1426
integer height = 140
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 21642288
long backcolor = 79741120
string text = "Calendario"
end type

type cb_6 from commandbutton within w_mant_horarios
integer x = 3369
integer y = 160
integer width = 389
integer height = 140
boolean bringtotop = true
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Salir"
end type

event clicked;close(parent)
end event

type r_4 from rectangle within w_mant_horarios
long linecolor = 12632256
integer linethickness = 4
long fillcolor = 21642288
integer x = 297
integer y = 148
integer width = 2249
integer height = 176
end type

type cb_borrar from commandbutton within w_mant_horarios
integer x = 2967
integer y = 160
integer width = 389
integer height = 140
boolean bringtotop = true
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
string text = "Borrar"
end type

event clicked;integer v_anyo
string v_calendario

v_anyo = integer(em_anyo.text)
v_calendario = uo_calendario.em_codigo.text

if Messagebox ("Aviso", "¿Seguro que desea borrar el calendario?", Exclamation!, YesNo!, 2) = 1 then
	delete from horarios 
	where empresa = :codigo_empresa 
	and anyo = :v_anyo
	and calendario = :v_calendario;
end if

if SQLCA.SQLCode = 0 then
	commit;
	Messagebox ("Aviso", "Se ha borrado el calendario", Exclamation!, OK!) 
else
	rollback;
	Messagebox ("Aviso", "No se ha podido borrar el calendario", Exclamation!, OK!) 
end if





end event

type em_anyo from editmask within w_mant_horarios
integer x = 1778
integer y = 216
integer width = 329
integer height = 72
integer taborder = 20
boolean bringtotop = true
integer textsize = -8
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
alignment alignment = center!
borderstyle borderstyle = stylelowered!
string mask = "#"
boolean spin = true
double increment = 1
string minmax = "~~"
end type

type st_1 from statictext within w_mant_horarios
integer x = 114
integer y = 544
integer width = 334
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Lunes"
boolean focusrectangle = false
end type

type st_8 from statictext within w_mant_horarios
integer x = 530
integer y = 540
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "De"
boolean focusrectangle = false
end type

type lunes_hora_inicial from dropdownlistbox within w_mant_horarios
integer x = 782
integer y = 528
integer width = 375
integer height = 440
integer taborder = 30
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if lunes_hora_inicial.text > lunes_hora_final.text and lunes_hora_inicial.text <> 'Inactivo' and lunes_hora_final.text <> 'Inactivo' then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	lunes_hora_inicial.selectitem(25)
	
end if

if lunes_hora_inicial.text = 'Inactivo' then
	
	lunes_hora_final.selectitem(25)
	
end if
end event

type st_9 from statictext within w_mant_horarios
integer x = 1262
integer y = 540
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "A"
boolean focusrectangle = false
end type

type lunes_hora_final from dropdownlistbox within w_mant_horarios
integer x = 1499
integer y = 528
integer width = 375
integer height = 440
integer taborder = 40
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if lunes_hora_inicial.text > lunes_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	lunes_hora_final.selectitem(25)
	
end if

if lunes_hora_final.text = 'Inactivo' then
	
	lunes_hora_inicial.selectitem(25)
	
end if
end event

type st_2 from statictext within w_mant_horarios
integer x = 114
integer y = 664
integer width = 334
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Martes"
boolean focusrectangle = false
end type

type st_3 from statictext within w_mant_horarios
integer x = 530
integer y = 660
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "De"
boolean focusrectangle = false
end type

type martes_hora_inicial from dropdownlistbox within w_mant_horarios
integer x = 786
integer y = 644
integer width = 375
integer height = 440
integer taborder = 50
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if martes_hora_inicial.text > martes_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	martes_hora_inicial.selectitem(25)
	
end if

if martes_hora_inicial.text = 'Inactivo' then
	
	martes_hora_final.selectitem(25)
	
end if
end event

type st_4 from statictext within w_mant_horarios
integer x = 1262
integer y = 660
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "A"
boolean focusrectangle = false
end type

type martes_hora_final from dropdownlistbox within w_mant_horarios
integer x = 1499
integer y = 648
integer width = 375
integer height = 440
integer taborder = 60
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if martes_hora_inicial.text > martes_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	martes_hora_final.selectitem(25)
	
end if

if martes_hora_final.text = 'Inactivo' then
	
	martes_hora_inicial.selectitem(25)
	
end if
end event

type st_5 from statictext within w_mant_horarios
integer x = 114
integer y = 784
integer width = 334
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Miércoles"
boolean focusrectangle = false
end type

type st_6 from statictext within w_mant_horarios
integer x = 530
integer y = 780
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "De"
boolean focusrectangle = false
end type

type miercoles_hora_inicial from dropdownlistbox within w_mant_horarios
integer x = 782
integer y = 768
integer width = 375
integer height = 440
integer taborder = 70
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if miercoles_hora_inicial.text > miercoles_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	miercoles_hora_inicial.selectitem(25)
	
end if

if miercoles_hora_inicial.text = 'Inactivo' then
	
	miercoles_hora_final.selectitem(25)
	
end if
end event

type st_7 from statictext within w_mant_horarios
integer x = 1262
integer y = 780
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "A"
boolean focusrectangle = false
end type

type miercoles_hora_final from dropdownlistbox within w_mant_horarios
integer x = 1499
integer y = 768
integer width = 375
integer height = 440
integer taborder = 80
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if miercoles_hora_inicial.text > miercoles_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	miercoles_hora_final.selectitem(25)
	
end if

if miercoles_hora_final.text = 'Inactivo' then
	
	miercoles_hora_inicial.selectitem(25)
	
end if
end event

type st_10 from statictext within w_mant_horarios
integer x = 114
integer y = 904
integer width = 334
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Jueves"
boolean focusrectangle = false
end type

type st_11 from statictext within w_mant_horarios
integer x = 530
integer y = 900
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "De"
boolean focusrectangle = false
end type

type jueves_hora_inicial from dropdownlistbox within w_mant_horarios
integer x = 782
integer y = 888
integer width = 375
integer height = 440
integer taborder = 90
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if jueves_hora_inicial.text > jueves_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	jueves_hora_inicial.selectitem(25)
	
end if

if jueves_hora_inicial.text = 'Inactivo' then
	
	jueves_hora_final.selectitem(25)
	
end if
end event

type st_12 from statictext within w_mant_horarios
integer x = 1262
integer y = 900
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "A"
boolean focusrectangle = false
end type

type jueves_hora_final from dropdownlistbox within w_mant_horarios
integer x = 1499
integer y = 888
integer width = 375
integer height = 440
integer taborder = 100
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if jueves_hora_inicial.text > jueves_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	jueves_hora_final.selectitem(25)
	
end if

if jueves_hora_final.text = 'Inactivo' then
	
	jueves_hora_inicial.selectitem(25)
	
end if
end event

type st_13 from statictext within w_mant_horarios
integer x = 114
integer y = 1024
integer width = 334
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Viernes"
boolean focusrectangle = false
end type

type st_14 from statictext within w_mant_horarios
integer x = 530
integer y = 1020
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "De"
boolean focusrectangle = false
end type

type viernes_hora_inicial from dropdownlistbox within w_mant_horarios
integer x = 782
integer y = 1008
integer width = 375
integer height = 440
integer taborder = 110
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if viernes_hora_inicial.text > viernes_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	viernes_hora_inicial.selectitem(25)
	
end if

if viernes_hora_inicial.text = 'Inactivo' then
	
	viernes_hora_final.selectitem(25)
	
end if
end event

type st_15 from statictext within w_mant_horarios
integer x = 1262
integer y = 1020
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "A"
boolean focusrectangle = false
end type

type viernes_hora_final from dropdownlistbox within w_mant_horarios
integer x = 1499
integer y = 1008
integer width = 375
integer height = 440
integer taborder = 120
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if viernes_hora_inicial.text > viernes_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	viernes_hora_inicial.selectitem(25)
	
end if

if viernes_hora_final.text = 'Inactivo' then
	
	viernes_hora_inicial.selectitem(25)
	
end if
end event

type st_16 from statictext within w_mant_horarios
integer x = 114
integer y = 1144
integer width = 334
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Sábado"
boolean focusrectangle = false
end type

type st_17 from statictext within w_mant_horarios
integer x = 530
integer y = 1140
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "De"
boolean focusrectangle = false
end type

type sabado_hora_inicial from dropdownlistbox within w_mant_horarios
integer x = 782
integer y = 1128
integer width = 375
integer height = 440
integer taborder = 130
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if sabado_hora_inicial.text > sabado_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	sabado_hora_inicial.selectitem(25)
	
end if

if sabado_hora_inicial.text = 'Inactivo' then
	
	sabado_hora_final.selectitem(25)
	
end if
end event

type st_18 from statictext within w_mant_horarios
integer x = 1262
integer y = 1140
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "A"
boolean focusrectangle = false
end type

type sabado_hora_final from dropdownlistbox within w_mant_horarios
integer x = 1499
integer y = 1128
integer width = 375
integer height = 440
integer taborder = 140
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if sabado_hora_inicial.text > sabado_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	sabado_hora_final.selectitem(25)
	
end if

if sabado_hora_final.text = 'Inactivo' then
	
	sabado_hora_inicial.selectitem(25)
	
end if
end event

type st_19 from statictext within w_mant_horarios
integer x = 114
integer y = 1264
integer width = 334
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Domingo"
boolean focusrectangle = false
end type

type st_20 from statictext within w_mant_horarios
integer x = 530
integer y = 1260
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "De"
boolean focusrectangle = false
end type

type domingo_hora_inicial from dropdownlistbox within w_mant_horarios
integer x = 782
integer y = 1248
integer width = 375
integer height = 440
integer taborder = 150
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if domingo_hora_inicial.text > domingo_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	domingo_hora_inicial.selectitem(25)
	
end if

if domingo_hora_inicial.text = 'Inactivo' then
	
	domingo_hora_final.selectitem(25)
	
end if
end event

type st_21 from statictext within w_mant_horarios
integer x = 1262
integer y = 1260
integer width = 192
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "A"
boolean focusrectangle = false
end type

type domingo_hora_final from dropdownlistbox within w_mant_horarios
integer x = 1499
integer y = 1248
integer width = 375
integer height = 440
integer taborder = 160
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
boolean vscrollbar = true
string item[] = {"Inactivo","00","01","02","03","04","05","06","07","08","09","10","11","12","13","14","15","16","17","18","19","20","21","22","23"}
borderstyle borderstyle = stylelowered!
end type

event selectionchanged;if domingo_hora_inicial.text > domingo_hora_final.text then
	
	messagebox("aviso", "No se puede poner una hora inicial mayor que una hora final")
	
	domingo_hora_final.selectitem(25)
	
end if

if domingo_hora_final.text = 'Inactivo' then
	
	domingo_hora_inicial.selectitem(25)
	
end if
end event

type st_22 from statictext within w_mant_horarios
integer x = 1984
integer y = 544
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha inicio"
boolean focusrectangle = false
end type

type st_23 from statictext within w_mant_horarios
integer x = 1984
integer y = 668
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha inicio"
boolean focusrectangle = false
end type

type st_24 from statictext within w_mant_horarios
integer x = 1984
integer y = 792
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha inicio"
boolean focusrectangle = false
end type

type st_25 from statictext within w_mant_horarios
integer x = 1984
integer y = 916
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha inicio"
boolean focusrectangle = false
end type

type st_26 from statictext within w_mant_horarios
integer x = 1984
integer y = 1040
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha inicio"
boolean focusrectangle = false
end type

type st_27 from statictext within w_mant_horarios
integer x = 1984
integer y = 1164
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha inicio"
boolean focusrectangle = false
end type

type st_28 from statictext within w_mant_horarios
integer x = 1984
integer y = 1288
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha inicio"
boolean focusrectangle = false
end type

type lunes_fecha_inicio from datepicker within w_mant_horarios
integer x = 2400
integer y = 532
integer width = 411
integer height = 100
integer taborder = 180
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type st_29 from statictext within w_mant_horarios
integer x = 2894
integer y = 544
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha final"
boolean focusrectangle = false
end type

type st_30 from statictext within w_mant_horarios
integer x = 2894
integer y = 668
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha final"
boolean focusrectangle = false
end type

type st_31 from statictext within w_mant_horarios
integer x = 2894
integer y = 792
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha final"
boolean focusrectangle = false
end type

type st_32 from statictext within w_mant_horarios
integer x = 2894
integer y = 916
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha final"
boolean focusrectangle = false
end type

type st_33 from statictext within w_mant_horarios
integer x = 2894
integer y = 1040
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha final"
boolean focusrectangle = false
end type

type st_34 from statictext within w_mant_horarios
integer x = 2894
integer y = 1164
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha final"
boolean focusrectangle = false
end type

type st_35 from statictext within w_mant_horarios
integer x = 2894
integer y = 1288
integer width = 370
integer height = 64
boolean bringtotop = true
integer textsize = -10
integer weight = 700
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Fecha final"
boolean focusrectangle = false
end type

type martes_fecha_inicio from datepicker within w_mant_horarios
integer x = 2400
integer y = 652
integer width = 411
integer height = 100
integer taborder = 200
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type miercoles_fecha_inicio from datepicker within w_mant_horarios
integer x = 2400
integer y = 776
integer width = 411
integer height = 100
integer taborder = 220
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type jueves_fecha_inicio from datepicker within w_mant_horarios
integer x = 2400
integer y = 900
integer width = 411
integer height = 100
integer taborder = 240
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type viernes_fecha_inicio from datepicker within w_mant_horarios
integer x = 2400
integer y = 1024
integer width = 411
integer height = 100
integer taborder = 260
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type sabado_fecha_inicio from datepicker within w_mant_horarios
integer x = 2400
integer y = 1144
integer width = 411
integer height = 100
integer taborder = 280
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type domingo_fecha_inicio from datepicker within w_mant_horarios
integer x = 2400
integer y = 1264
integer width = 411
integer height = 100
integer taborder = 300
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type lunes_fecha_fin from datepicker within w_mant_horarios
integer x = 3282
integer y = 532
integer width = 411
integer height = 100
integer taborder = 190
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type martes_fecha_fin from datepicker within w_mant_horarios
integer x = 3282
integer y = 652
integer width = 411
integer height = 100
integer taborder = 210
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type miercoles_fecha_fin from datepicker within w_mant_horarios
integer x = 3282
integer y = 776
integer width = 411
integer height = 100
integer taborder = 230
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type jueves_fecha_fin from datepicker within w_mant_horarios
integer x = 3282
integer y = 900
integer width = 411
integer height = 100
integer taborder = 250
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type viernes_fecha_fin from datepicker within w_mant_horarios
integer x = 3282
integer y = 1024
integer width = 411
integer height = 100
integer taborder = 270
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type sabado_fecha_fin from datepicker within w_mant_horarios
integer x = 3282
integer y = 1144
integer width = 411
integer height = 100
integer taborder = 290
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type domingo_fecha_fin from datepicker within w_mant_horarios
integer x = 3282
integer y = 1264
integer width = 411
integer height = 100
integer taborder = 310
boolean bringtotop = true
boolean border = true
borderstyle borderstyle = stylelowered!
date maxdate = Date("2999-12-31")
date mindate = Date("1800-01-01")
datetime value = DateTime(Date("2019-08-06"), Time("11:05:05.000000"))
integer textsize = -10
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
integer calendarfontweight = 400
boolean todaysection = true
boolean todaycircle = true
end type

type p_1 from picture within w_mant_horarios
integer x = 3781
integer y = 544
integer width = 110
integer height = 76
boolean bringtotop = true
string picturename = "C:\bmp\NEXT2.BMP"
boolean focusrectangle = false
end type

event clicked;f_actualizar_dia(lunes_fecha_inicio.gettext(),lunes_fecha_fin.gettext(),lunes_hora_inicial.text,lunes_hora_final.text,uo_calendario.em_codigo.text,em_anyo.text,"Lunes")

end event

type p_2 from picture within w_mant_horarios
integer x = 3781
integer y = 660
integer width = 110
integer height = 76
boolean bringtotop = true
string picturename = "C:\bmp\NEXT2.BMP"
boolean focusrectangle = false
end type

event clicked;f_actualizar_dia(martes_fecha_inicio.gettext(),martes_fecha_fin.gettext(),martes_hora_inicial.text,martes_hora_final.text,uo_calendario.em_codigo.text,em_anyo.text,"Martes")
end event

type p_3 from picture within w_mant_horarios
integer x = 3781
integer y = 788
integer width = 110
integer height = 76
boolean bringtotop = true
string picturename = "C:\bmp\NEXT2.BMP"
boolean focusrectangle = false
end type

event clicked;f_actualizar_dia(miercoles_fecha_inicio.gettext(),miercoles_fecha_fin.gettext(),miercoles_hora_inicial.text,miercoles_hora_final.text,uo_calendario.em_codigo.text,em_anyo.text,"Miércoles")
end event

type p_4 from picture within w_mant_horarios
integer x = 3781
integer y = 908
integer width = 110
integer height = 76
boolean bringtotop = true
string picturename = "C:\bmp\NEXT2.BMP"
boolean focusrectangle = false
end type

event clicked;f_actualizar_dia(jueves_fecha_inicio.gettext(),jueves_fecha_fin.gettext(),jueves_hora_inicial.text,jueves_hora_final.text,uo_calendario.em_codigo.text,em_anyo.text,"Jueves")
end event

type p_5 from picture within w_mant_horarios
integer x = 3781
integer y = 1036
integer width = 110
integer height = 76
boolean bringtotop = true
string picturename = "C:\bmp\NEXT2.BMP"
boolean focusrectangle = false
end type

event clicked;f_actualizar_dia(viernes_fecha_inicio.gettext(),viernes_fecha_fin.gettext(),viernes_hora_inicial.text,viernes_hora_final.text,uo_calendario.em_codigo.text,em_anyo.text,"Viernes")
end event

type p_6 from picture within w_mant_horarios
integer x = 3781
integer y = 1160
integer width = 110
integer height = 76
boolean bringtotop = true
string picturename = "C:\bmp\NEXT2.BMP"
boolean focusrectangle = false
end type

event clicked;f_actualizar_dia(sabado_fecha_inicio.gettext(),sabado_fecha_fin.gettext(),sabado_hora_inicial.text,sabado_hora_final.text,uo_calendario.em_codigo.text,em_anyo.text,"Sábado")
end event

type p_7 from picture within w_mant_horarios
integer x = 3781
integer y = 1276
integer width = 110
integer height = 76
boolean bringtotop = true
string picturename = "C:\bmp\NEXT2.BMP"
boolean focusrectangle = false
end type

event clicked;f_actualizar_dia(domingo_fecha_inicio.gettext(),domingo_fecha_fin.gettext(),domingo_hora_inicial.text,domingo_hora_final.text,uo_calendario.em_codigo.text,em_anyo.text,"Domingo")
end event

type todos_calendarios from checkbox within w_mant_horarios
integer x = 3008
integer y = 408
integer width = 896
integer height = 80
boolean bringtotop = true
integer textsize = -10
integer weight = 400
fontcharset fontcharset = ansi!
fontpitch fontpitch = variable!
fontfamily fontfamily = swiss!
string facename = "Arial"
long textcolor = 33554432
long backcolor = 553648127
string text = "Aplicar a todos los calendarios"
end type

type r_1 from rectangle within w_mant_horarios
long linecolor = 12632256
integer linethickness = 4
long fillcolor = 21642288
integer x = 2949
integer y = 144
integer width = 827
integer height = 176
end type

